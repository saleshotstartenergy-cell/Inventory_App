{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <a href="{{ url_for('stock_summary') }}" class="btn btn-secondary">â¬… Back</a>
  <h2>Search Results for "{{ query }}"</h2>
</div>

{% if items %}
<div class="table-responsive">
  <table class="table table-bordered table-striped table-sm align-middle">
    <thead class="thead-dark">
      <tr>
        <th>Item</th>
        <th>Brand</th>
        <th>Total Qty</th>
        <th>Reserved</th>
        <th>Available</th>
        <th>Reserve</th>
      </tr>
    </thead>
    <tbody>
      {% for i in items %}
      <tr>
        <td>{{ i.name }}</td>
        <td>{{ i.category }}</td>
        <td>{{ i.total_qty }}</td>
        <td>{{ i.reserved_qty }}</td>
        <td>
          {% if i.available_qty <= 0 %}
            <span class="text-danger fw-bold">0</span>
          {% else %}
            {{ i.available_qty }}
          {% endif %}
        </td>
        <td>
          {% if i.available_qty > 0 %}
          <form method="POST" class="d-flex gap-1 align-items-center">
            <input type="hidden" name="item" value="{{ i.name }}">
            <input type="number" name="qty" min="1" max="{{ i.available_qty }}" required class="form-control form-control-sm" style="width: 80px;">
            <input type="number" name="days" min="1" max="5" value="2" class="form-control form-control-sm" style="width: 70px;">
            <button type="submit" class="btn btn-sm btn-primary">Reserve</button>
          </form>
          {% else %}
            <span class="text-muted">Fully Reserved</span>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% else %}
<p class="text-muted text-center">No matching items found.</p>
{% endif %}
{% endblock %}
